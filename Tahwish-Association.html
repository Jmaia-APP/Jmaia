<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>جمعية تحويش</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    .tahwish-item.active {
      border-color: #4CAF50;
      box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.5);
    }

    .duration-option.active {
      background-color: #4CAF50;
      color: white;
      border-color: #4CAF50;
    }

    .duration-option:hover:not(.active) {
      background-color: #e6ffe6;
    }

    .tahwish-item:hover:not(.active) {
      border-color: #A5D6A7;
      box-shadow: 0 0 0 1px rgba(76, 175, 80, 0.2);
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
    }

    .modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background-color: white;
      padding: 2rem;
      border-radius: 0.5rem;
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
      width: 95%;
      max-width: 500px;
    }
  </style>
</head>

<body class="bg-gray-100 min-h-screen font-sans p-4">
  <div class="max-w-7xl mx-auto flex flex-col lg:flex-row gap-6">
    <div class="w-full">
      <div class="flex items-center justify-between mb-6">
        <button onclick="window.history.back()" class="text-gray-600 hover:text-green-600 text-2xl" aria-label="رجوع">
          <i class="bi bi-arrow-right"></i>
        </button>
        <span class="text-xl font-bold text-gray-800">جمعية تحويش</span>
      </div>

      <div class="bg-white p-4 rounded-lg shadow-lg">
        <h2 class="text-2xl font-extrabold mb-6 text-gray-800 flex items-center justify-between">
          <span>اختار جمعية تحويش</span>
          <span class="text-green-500 text-4xl">🌿</span>
        </h2>

        <div id="tahwish-options" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
          <!-- Elements will be generated by JS -->
        </div>

        <p class="text-sm text-blue-500 mt-6 text-center cursor-pointer hover:underline">
          لم توجد ما تبحث عنه؟ <span class="font-medium">طلب المساعدة</span>
        </p>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="duration-modal-overlay" class="modal-overlay">
    <div class="modal-content overflow-y-auto max-h-[90vh]">
      <h2 class="text-2xl font-extrabold mb-6 text-gray-800 flex items-center justify-between">
        <span>اختار المدة</span>
        <button id="close-modal-btn" class="text-gray-400 hover:text-gray-600 transition">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </h2>

      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8">
        <button class="duration-option p-4 border rounded-lg" data-duration="6">
          <span class="main-text font-semibold text-lg text-gray-700">6 شهور</span>
          <span class="sub-text text-sm text-gray-500 mt-1">-- ر.س/شهريًا</span>
        </button>
        <button class="duration-option p-4 border rounded-lg" data-duration="12">
          <span class="main-text font-semibold text-lg text-gray-700">12 شهر</span>
          <span class="sub-text text-sm text-gray-500 mt-1">-- ر.س/شهريًا</span>
        </button>
        <button class="duration-option p-4 border rounded-lg" data-duration="24">
          <span class="main-text font-semibold text-lg text-gray-700">24 شهر</span>
          <span class="sub-text text-sm text-gray-500 mt-1">-- ر.س/شهريًا</span>
        </button>
      </div>

      <div class="bg-gray-50 rounded-lg p-4 shadow-inner">
        <div class="flex justify-between py-2 border-b border-dashed border-gray-200">
          <p class="text-sm text-gray-500">تبدأ في</p>
          <p id="start-date" class="font-bold text-base text-gray-900">--</p>
        </div>
        <div class="flex justify-between py-2 border-b border-dashed border-gray-200">
          <p class="text-sm text-gray-500">تنتهي في</p>
          <p id="end-date" class="font-bold text-base text-gray-900">--</p>
        </div>
        <div class="flex justify-between py-2 border-b border-dashed border-gray-200">
          <p class="text-sm text-gray-500">إجمالي القبض</p>
          <p id="total-receipt" class="font-bold text-lg text-green-600">-- ر.س</p>
        </div>
        <div class="flex justify-between py-2">
          <p class="text-sm text-gray-500">المبلغ الشهري</p>
          <p id="monthly-amount" class="font-bold text-lg text-blue-500">-- ر.س</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Script -->
  <script>
    const tahwishData = [
      { title: "تحويش لايت", base: 3000, increase: 0 },
      { title: "تحويش برونزي", base: 6000, increase: 1000 },
      { title: "تحويش فضي", base: 12000, increase: 2400 },
      { title: "تحويش ذهبي", base: 30000, increase: 5000 },
      { title: "تحويش بلاتيني", base: 60000, increase: 12000 },
      { title: "تحويش ألماس", base: 100000, increase: 20000 },
      { title: "تحويش متقدم", base: 250000, increase: 75000 },
      { title: "تحويش نخبة", base: 500000, increase: 182000 },
      { title: "تحويش مميز", base: 1000000, increase: 200000 },
    ];

    const tahwishOptions = document.getElementById("tahwish-options");
    const modal = document.getElementById("duration-modal-overlay");
    const closeBtn = document.getElementById("close-modal-btn");
    const durationOptions = document.querySelectorAll(".duration-option");
    const startDateEl = document.getElementById("start-date");
    const endDateEl = document.getElementById("end-date");
    const totalReceiptEl = document.getElementById("total-receipt");
    const monthlyAmountEl = document.getElementById("monthly-amount");

    let selectedBase = 0, selectedIncrease = 0, selectedDuration = 0;

    tahwishData.forEach(item => {
      const div = document.createElement("div");
      div.className = "tahwish-item p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-400 transition";
      div.dataset.base = item.base;
      div.dataset.increase = item.increase;
      div.innerHTML = `
        <p class="font-semibold text-lg text-gray-700">${item.title}</p>
        <p class="text-green-600 font-bold text-xl">${item.base.toLocaleString()} ر.س</p>
        <p class="text-sm text-gray-500">حتى ${item.increase.toLocaleString()} ر.س زيادة</p>
      `;
      div.addEventListener("click", () => {
        document.querySelectorAll(".tahwish-item").forEach(el => el.classList.remove("active"));
        div.classList.add("active");
        selectedBase = item.base;
        selectedIncrease = item.increase;
        updateDurationRates();
        modal.classList.add("show");
        document.body.style.overflow = "hidden";
      });
      tahwishOptions.appendChild(div);
    });

    durationOptions.forEach(btn => {
      btn.addEventListener("click", () => {
        durationOptions.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        selectedDuration = parseInt(btn.dataset.duration);
        updateResults();
      });
    });

    closeBtn.addEventListener("click", () => {
      modal.classList.remove("show");
      document.body.style.overflow = "auto";
      selectedBase = selectedIncrease = selectedDuration = 0;
      durationOptions.forEach(btn => btn.classList.remove("active"));
      document.querySelectorAll(".tahwish-item").forEach(el => el.classList.remove("active"));
      updateResults();
    });

    modal.addEventListener("click", (e) => {
      if (e.target === modal) closeBtn.click();
    });

    function updateDurationRates() {
      durationOptions.forEach(btn => {
        const d = parseInt(btn.dataset.duration);
        const total = selectedBase + selectedIncrease * d;
        const monthly = total / d;
        btn.querySelector(".sub-text").textContent = `${monthly.toLocaleString()} ر.س/شهريًا`;
      });
    }

    function updateResults() {
      if (selectedBase && selectedDuration) {
        const now = new Date();
        const start = now.toLocaleDateString('ar-SA', { month: 'long', year: 'numeric' });
        const end = new Date();
        end.setMonth(end.getMonth() + selectedDuration);
        const endFormatted = end.toLocaleDateString('ar-SA', { month: 'long', year: 'numeric' });

        const total = selectedBase + selectedIncrease * selectedDuration;
        const monthly = total / selectedDuration;

        startDateEl.textContent = start;
        endDateEl.textContent = endFormatted;
        totalReceiptEl.textContent = `${total.toLocaleString()} ر.س`;
        monthlyAmountEl.textContent = `${monthly.toLocaleString()} ر.س`;
      } else {
        startDateEl.textContent = endDateEl.textContent = '--';
        totalReceiptEl.textContent = monthlyAmountEl.textContent = '-- ر.س';
      }
    }
  </script>
</body>

</html>
